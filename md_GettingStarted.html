<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>WindowsDevicePortalWrapper: Installing the project</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">WindowsDevicePortalWrapper
   &#160;<span id="projectnumber">0.9.0.0</span>
   </div>
   <div id="projectbrief">A client library that wraps the Windows Device Portal REST APIs.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Installing the project </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The easiest way to get started is to clone this project to a local repo and open the solution in Visual Studio. From there, you can compile the library (either .NET or UWP, as needed) and copy the DLL from the /bin/Release folder in that project. Adding this DLL to an existing project will allow you to use Device Portal Wrapper.</p>
<p>Alternately, to quickly test out the Device Portal Wrapper, you can open one of the <a class="el" href="namespace_sample_wdp_client.html">SampleWdpClient</a> apps and begin modifying from there.</p>
<p><b>Note</b>: Device Portal Wrapper requires .NET 4.5.2 from the <a href="https://developer.microsoft.com/en-US/windows/downloads/windows-10-sdk">Windows SDK</a>.</p>
<h1>Using Device Portal Wrapper</h1>
<p>The Device Portal Wrapper is built around a single object, the DevicePortal, which represents a Device Portal service instance running on a machine (either local or remote to the client). The object is used to trigger Device Portal REST APIs on the target device (shutdown, app launch, etc).</p>
<p><b>Note</b>: The examples in the Getting Started guide assume that you have referenced <a class="el" href="namespace_microsoft_1_1_tools_1_1_windows_device_portal.html">Microsoft.Tools.WindowsDevicePortal</a> in your project.</p>
<h2>Creating a DevicePortal object</h2>
<p>The DevicePortal object is initialized with a DevicePortalConnection object, which handles the connection between the client and the service on the target. The Device Portal Wrapper comes with a basic DefaultDevicePortalConnection implementation that can connect to IoT, HoloLens, Xbox, and Desktop instances. Once the object is created, the connection can be established using the Connect method.</p>
<p>Example - initializing and establishing a Device Portal connection: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C#}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;DevicePortal portal = new DevicePortal(</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;  new DefaultDevicePortalConnection(</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;    address, // a full URI (e.g. &#39;https://localhost:50443&#39;)</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    username,</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    password));</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;portal.Connect().Wait(); // The ConnectionStatus event will tell you if it succeeded </div></div><!-- fragment --><p> For complete examples and stepping off points see the SampleWdpClients. A UWP version and WPF version of the sample app are included in the solution.</p>
<h3>Verifying your connection</h3>
<p>There are several different ways to verify your connection for using secure HTTPS communication with a device. Any of these methods can be used to secure your connection against a Man in the Middle attack or to allow your own proxy for debugging your communication.</p>
<ol type="1">
<li>If the certificate generated by your device is in your Trusted Root Certification Authorities certificate store then the connection will be automatically verified when connecting. No additional work is necessary.</li>
<li>You can manually provide the certificate object to the Connect method on the DevicePortal object to use for verification. This certificate could have been retrieved earlier via USB, or downloaded via a call to &lt;address&gt;/config/rootcertificate and then manually verified as being the proper certificate. This is a good method to use if using a web proxy such as Fiddler, as those proxies generally let you export their certificate.</li>
<li>Add your own logic for certificate checking. This works differently in Win32 and UWP<ul>
<li>For UWP, you can make a call to the GetRootDeviceCertificate method on your DevicePortal object with the acceptUntrustedCerts parameter set to true. This will allow untrusted connections to your device for subsequent calls. <b>You should warn your user that they are making an untrusted connection or otherwise verify your connection is secure if using this method.</b></li>
<li>For Win32, you can add a handler to the UnvalidatedCert event on your DevicePortal object which gives you a chance to perform custom handling such as presenting the thumbprint for the certificate to the user and asking them if they trust the connection, or using a prior cached decision about this connection. This is similar to how a web browser handles untrusted certificates.</li>
</ul>
</li>
</ol>
<p>The SampleWdpClients show examples of using all of these methods of establishing trust in an application.</p>
<h2>Using the DevicePortal object</h2>
<p>Each REST API exposed by Device Portal is represented as a method off of the DevicePortal object. Most methods are a task that return an object representing the JSON return value.</p>
<p>Example - finding a calculator app installed on the device: </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C#}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;AppPackages apps = await portal.GetInstalledAppPackages();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;PackageInfo package = apps.Packages.First(x =&gt; x.Name.Contains(&quot;calc&quot;));</div></div><!-- fragment --><h3>Connecting over WebSocket</h3>
<p>You can also establish websocket connections, for instance to get <a class="el" href="namespace_system.html">System</a> Performance or Running Process information on a push basis. Events are fired by the portal for each push of data from the server, and begin firing once the websocket connection is established.</p>
<p>Example - print the process with the highest memory consumption, and stop listing processes if it's the Contoso process. </p><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;{C#}</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;await  portal.StartListeningForRunningProcesses();</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;portal.RunningProcessesMessageReceived += (portal, args) =&gt;</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;  {</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;    DeviceProcessInfo proc =  args.Message.Processes.OrderByDescending(x=&gt;x.TotalCommit).First();</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;    Console.WriteLine(&quot;Process with highest total commit:{0} - {1} &quot;, proc.ProcessId, proc.Name);</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;    if (proc.Name.Contains(&quot;Contoso&quot;))</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;      {</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;        portal.StopListeningForRunningProcesses();</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;      }</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;  };</div></div><!-- fragment --><h2>Using the Sample Apps and DefaultDevicePortalConnection</h2>
<p>The <a class="el" href="namespace_sample_wdp_client.html">SampleWdpClient</a> apps are built on top of the DefaultDevicePortalConnection, which allows them to connect to most devices. At this time, the DefaultDevicePortalConnection is incompatible with <a class="el" href="namespace_windows.html">Windows</a> Phone. To connect using one of the sample apps, you can enter the full protocol, IP, and port for the target device.</p>
<table class="doxtable">
<tr>
<th>Platform </th><th>Default Uri  </th></tr>
<tr>
<td>PC </td><td><a href="https://ipAddress:50443">https://ipAddress:50443</a> </td></tr>
<tr>
<td>Xbox </td><td><a href="https://ipAddress:11443">https://ipAddress:11443</a> </td></tr>
<tr>
<td>IoT </td><td><a href="http://ipAddress:8080">http://ipAddress:8080</a> </td></tr>
<tr>
<td>HoloLens </td><td><a href="https://ipAddress">https://ipAddress</a> </td></tr>
</table>
<p>Once connected to the target device, you can see basic device information, collect the IP Config for the device, and power cycle it.</p>
<p>There is also an https://github.com/Microsoft/WindowsDevicePortalWrapper/blob/master/XboxWDPDriver.md "Xbox console application" which provides a helpful and extensible command line tool when working on Xbox. </p>
</div></div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
